import nmap

class PortScanner:
    
    def __init__(self, ip):
        self.ip = ip
        self.nm = nmap.PortScanner()
        self.nm.scan(self.ip, '1-1024')
    
    def open_ports_proto(self,protocol):
        for proto in self.nm[self.ip].all_protocols():
            if proto == protocol:
                return self.nm[self.ip][proto].keys()
    
    def open_ports_protocols(self):
        dico = {}
        for proto in self.nm[self.ip].all_protocols():
            dico[proto] = list(self.nm[self.ip][proto].keys())
        return dico
            